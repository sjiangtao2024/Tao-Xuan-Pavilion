<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº§å“ç¼–è¾‘åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #ffffff;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        .test-btn {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            margin: 10px;
            transition: all 0.3s;
        }
        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(243, 156, 18, 0.4);
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
        }
        .success { border-left: 5px solid #27ae60; }
        .error { border-left: 5px solid #e74c3c; }
        .info { border-left: 5px solid #3498db; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ› ï¸ äº§å“ç¼–è¾‘åŠŸèƒ½æµ‹è¯•</h1>
        <p>æµ‹è¯•äº§å“ç¼–è¾‘å™¨æ¨¡å—æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>
        
        <div>
            <button class="test-btn" onclick="testCreateProduct()">æµ‹è¯•åˆ›å»ºäº§å“</button>
            <button class="test-btn" onclick="testEditProduct()">æµ‹è¯•ç¼–è¾‘äº§å“</button>
            <button class="test-btn" onclick="testLanguageSwitch()">æµ‹è¯•è¯­è¨€åˆ‡æ¢</button>
        </div>
        
        <div id="status" class="status info">
            âœ… é¡µé¢å·²åŠ è½½ï¼Œç­‰å¾…æµ‹è¯•...
        </div>
        
        <div id="test-results"></div>
    </div>

    <!-- æ¨¡æ‹ŸåŠ è½½æ¨¡å— -->
    <script>
        // æ¨¡æ‹ŸlocalStorageä¸­çš„adminToken
        if (!localStorage.getItem('adminToken')) {
            localStorage.setItem('adminToken', 'test-token-123');
        }
        
        // æ¨¡æ‹ŸåŠ è½½äº§å“ç¼–è¾‘å™¨æ¨¡å—
        loadProductEditorModule();
        
        async function loadProductEditorModule() {
            try {
                updateStatus('info', 'ğŸ”„ æ­£åœ¨åŠ è½½äº§å“ç¼–è¾‘å™¨æ¨¡å—...');
                
                // æ¨¡æ‹ŸåŠ è½½æ¨¡å—å†…å®¹ï¼ˆå®é™…ç¯å¢ƒä¸­ä¼šä»/modules/product-editor.jsåŠ è½½ï¼‰
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // åˆå§‹åŒ–äº§å“ç¼–è¾‘å™¨ï¼ˆè¿™é‡Œä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬ï¼‰
                initializeSimpleProductEditor();
                
                updateStatus('success', 'âœ… äº§å“ç¼–è¾‘å™¨æ¨¡å—åŠ è½½æˆåŠŸï¼');
                
            } catch (error) {
                updateStatus('error', 'âŒ æ¨¡å—åŠ è½½å¤±è´¥: ' + error.message);
            }
        }
        
        function initializeSimpleProductEditor() {
            // ç®€åŒ–çš„äº§å“ç¼–è¾‘å™¨å®ç°ç”¨äºæµ‹è¯•
            window.initializeProductEditor = function() {
                console.log('äº§å“ç¼–è¾‘å™¨å·²åˆå§‹åŒ–');
            };
            
            window.openProductEditor = function(productData, mode = 'create') {
                console.log('æ‰“å¼€äº§å“ç¼–è¾‘å™¨:', mode, productData);
                
                // åˆ›å»ºç®€å•çš„æµ‹è¯•æ¨¡æ€æ¡†
                if (!document.getElementById('test-editor-modal')) {
                    createTestEditorModal();
                }
                
                const modal = document.getElementById('test-editor-modal');
                modal.style.display = 'block';
                
                const title = document.getElementById('test-editor-title');
                title.textContent = mode === 'edit' ? 'ç¼–è¾‘äº§å“' : 'åˆ›å»ºäº§å“';
                
                if (productData && mode === 'edit') {
                    document.getElementById('test-product-name').value = productData.name_zh || productData.name || '';
                    document.getElementById('test-product-price').value = productData.price || '';
                } else {
                    document.getElementById('test-product-name').value = '';
                    document.getElementById('test-product-price').value = '';
                }
                
                updateTestResults(`${mode === 'edit' ? 'ç¼–è¾‘' : 'åˆ›å»º'}äº§å“ç¼–è¾‘å™¨å·²æ‰“å¼€`);
            };
            
            window.closeProductEditor = function() {
                const modal = document.getElementById('test-editor-modal');
                if (modal) {
                    modal.style.display = 'none';
                }
                updateTestResults('äº§å“ç¼–è¾‘å™¨å·²å…³é—­');
            };
            
            window.switchLanguage = function(lang) {
                console.log('åˆ‡æ¢è¯­è¨€åˆ°:', lang);
                updateTestResults(`è¯­è¨€å·²åˆ‡æ¢åˆ°: ${lang === 'zh' ? 'ä¸­æ–‡' : 'English'}`);
            };
        }
        
        function createTestEditorModal() {
            const modalHTML = `
                <div id="test-editor-modal" style="
                    display: none; position: fixed; z-index: 10000; left: 0; top: 0;
                    width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8);
                    backdrop-filter: blur(5px);
                ">
                    <div style="
                        background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
                        margin: 5% auto; padding: 30px; border-radius: 15px;
                        width: 90%; max-width: 600px; color: #ffffff;
                        border: 2px solid #f39c12;
                    ">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h2 id="test-editor-title" style="color: #f39c12; margin: 0;">äº§å“ç¼–è¾‘å™¨</h2>
                            <button onclick="closeProductEditor()" style="
                                background: none; border: none; color: #aaa; font-size: 24px; cursor: pointer;
                            ">&times;</button>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <button onclick="switchLanguage('zh')" style="
                                background: #f39c12; color: #000; border: none; padding: 8px 16px; 
                                border-radius: 5px; margin-right: 10px; cursor: pointer;
                            ">ä¸­æ–‡</button>
                            <button onclick="switchLanguage('en')" style="
                                background: #3498db; color: #fff; border: none; padding: 8px 16px; 
                                border-radius: 5px; cursor: pointer;
                            ">English</button>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; color: #f39c12; margin-bottom: 5px;">äº§å“åç§°:</label>
                            <input id="test-product-name" type="text" placeholder="è¾“å…¥äº§å“åç§°..." style="
                                width: 100%; padding: 10px; border: 1px solid #555; border-radius: 5px;
                                background: rgba(255,255,255,0.1); color: #fff; box-sizing: border-box;
                            ">
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; color: #f39c12; margin-bottom: 5px;">ä»·æ ¼ (USD):</label>
                            <input id="test-product-price" type="number" step="0.01" placeholder="0.00" style="
                                width: 100%; padding: 10px; border: 1px solid #555; border-radius: 5px;
                                background: rgba(255,255,255,0.1); color: #fff; box-sizing: border-box;
                            ">
                        </div>
                        
                        <div style="text-align: center;">
                            <button onclick="saveTestProduct()" style="
                                background: #27ae60; color: #fff; border: none; padding: 12px 24px;
                                border-radius: 8px; cursor: pointer; margin-right: 10px;
                            ">ä¿å­˜</button>
                            <button onclick="closeProductEditor()" style="
                                background: #95a5a6; color: #fff; border: none; padding: 12px 24px;
                                border-radius: 8px; cursor: pointer;
                            ">å–æ¶ˆ</button>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHTML);
        }
        
        function testCreateProduct() {
            updateStatus('info', 'ğŸ§ª æµ‹è¯•åˆ›å»ºäº§å“åŠŸèƒ½...');
            try {
                openProductEditor(null, 'create');
                updateStatus('success', 'âœ… åˆ›å»ºäº§å“æµ‹è¯•æˆåŠŸï¼');
            } catch (error) {
                updateStatus('error', 'âŒ åˆ›å»ºäº§å“æµ‹è¯•å¤±è´¥: ' + error.message);
            }
        }
        
        function testEditProduct() {
            updateStatus('info', 'ğŸ§ª æµ‹è¯•ç¼–è¾‘äº§å“åŠŸèƒ½...');
            try {
                const mockProduct = {
                    id: 1,
                    name_zh: 'æµ‹è¯•äº§å“',
                    name_en: 'Test Product',
                    price: 29.99,
                    description_zh: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•äº§å“',
                    description_en: 'This is a test product'
                };
                openProductEditor(mockProduct, 'edit');
                updateStatus('success', 'âœ… ç¼–è¾‘äº§å“æµ‹è¯•æˆåŠŸï¼');
            } catch (error) {
                updateStatus('error', 'âŒ ç¼–è¾‘äº§å“æµ‹è¯•å¤±è´¥: ' + error.message);
            }
        }
        
        function testLanguageSwitch() {
            updateStatus('info', 'ğŸ§ª æµ‹è¯•è¯­è¨€åˆ‡æ¢åŠŸèƒ½...');
            try {
                switchLanguage('en');
                setTimeout(() => switchLanguage('zh'), 1000);
                updateStatus('success', 'âœ… è¯­è¨€åˆ‡æ¢æµ‹è¯•æˆåŠŸï¼');
            } catch (error) {
                updateStatus('error', 'âŒ è¯­è¨€åˆ‡æ¢æµ‹è¯•å¤±è´¥: ' + error.message);
            }
        }
        
        function saveTestProduct() {
            const name = document.getElementById('test-product-name').value;
            const price = document.getElementById('test-product-price').value;
            
            if (!name.trim()) {
                alert('è¯·è¾“å…¥äº§å“åç§°');
                return;
            }
            
            if (!price || price <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆä»·æ ¼');
                return;
            }
            
            updateTestResults(`äº§å“ä¿å­˜æˆåŠŸ: ${name} - $${price}`);
            closeProductEditor();
        }
        
        function updateStatus(type, message) {
            const statusEl = document.getElementById('status');
            statusEl.className = `status ${type}`;
            statusEl.textContent = message;
        }
        
        function updateTestResults(message) {
            const resultsEl = document.getElementById('test-results');
            const time = new Date().toLocaleTimeString();
            resultsEl.innerHTML += `<div style="margin: 10px 0; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px;">[${time}] ${message}</div>`;
        }
    </script>
</body>
</html>