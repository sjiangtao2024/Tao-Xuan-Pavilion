<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº§å“ç¼–è¾‘å™¨æµ‹è¯•</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background: #1a1a1a; 
            color: white; 
            padding: 20px; 
        }
        .test-container { 
            max-width: 800px; 
            margin: 0 auto; 
        }
        .test-btn { 
            background: #f39c12; 
            color: black; 
            border: none; 
            padding: 12px 20px; 
            margin: 10px; 
            border-radius: 5px; 
            cursor: pointer; 
            font-weight: bold; 
        }
        .status { 
            margin: 20px 0; 
            padding: 15px; 
            border-radius: 5px; 
        }
        .success { background: rgba(39, 174, 96, 0.2); border: 1px solid #27ae60; }
        .error { background: rgba(231, 76, 60, 0.2); border: 1px solid #e74c3c; }
        .warning { background: rgba(243, 156, 18, 0.2); border: 1px solid #f39c12; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ§ª äº§å“ç¼–è¾‘å™¨æ¨¡å—æµ‹è¯•</h1>
        
        <div id="status-container">
            <div class="status warning">æ­£åœ¨åŠ è½½æ¨¡å—...</div>
        </div>
        
        <div class="test-actions">
            <button class="test-btn" onclick="testModuleStatus()">æ£€æŸ¥æ¨¡å—çŠ¶æ€</button>
            <button class="test-btn" onclick="testCreateProduct()">æµ‹è¯•åˆ›å»ºäº§å“</button>
            <button class="test-btn" onclick="testEditProduct()">æµ‹è¯•ç¼–è¾‘äº§å“</button>
        </div>
        
        <div id="debug-info" style="margin-top: 30px;">
            <h3>è°ƒè¯•ä¿¡æ¯:</h3>
            <div id="debug-content" style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 5px; font-family: monospace; white-space: pre-wrap;"></div>
        </div>
    </div>

    <script>
        let debugLog = '';
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            debugLog += `[${timestamp}] ${type.toUpperCase()}: ${message}\n`;
            document.getElementById('debug-content').textContent = debugLog;
            console.log(`[${type}]`, message);
        }
        
        function updateStatus(message, type = 'warning') {
            const container = document.getElementById('status-container');
            container.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function testModuleStatus() {
            log('å¼€å§‹æ£€æŸ¥æ¨¡å—çŠ¶æ€...');
            
            const modules = {
                'Product Editor': typeof window.initializeProductEditor,
                'Product Form': typeof window.initializeProductForm,
                'Product Media': typeof window.initializeProductMedia,
                'Open Editor': typeof window.openProductEditor,
                'Close Editor': typeof window.closeProductEditor
            };
            
            let allLoaded = true;
            let statusHTML = '';
            
            for (const [name, type] of Object.entries(modules)) {
                const isLoaded = type === 'function';
                if (!isLoaded) allLoaded = false;
                
                statusHTML += `<div><strong>${name}</strong>: ${type} ${isLoaded ? 'âœ…' : 'âŒ'}</div>`;
                log(`${name}: ${type}`, isLoaded ? 'success' : 'error');
            }
            
            updateStatus(statusHTML, allLoaded ? 'success' : 'error');
            
            if (allLoaded) {
                log('æ‰€æœ‰æ¨¡å—éƒ½å·²æ­£ç¡®åŠ è½½ï¼', 'success');
            } else {
                log('éƒ¨åˆ†æ¨¡å—æœªæ­£ç¡®åŠ è½½ï¼Œéœ€è¦æ£€æŸ¥', 'warning');
            }
        }
        
        function testCreateProduct() {
            log('æµ‹è¯•åˆ›å»ºäº§å“åŠŸèƒ½...');
            
            if (typeof window.openProductEditor === 'function') {
                try {
                    window.openProductEditor(null, 'create');
                    log('åˆ›å»ºäº§å“ç¼–è¾‘å™¨æˆåŠŸè°ƒç”¨', 'success');
                    updateStatus('åˆ›å»ºäº§å“ç¼–è¾‘å™¨æµ‹è¯•æˆåŠŸ âœ…', 'success');
                } catch (error) {
                    log(`åˆ›å»ºäº§å“ç¼–è¾‘å™¨å¤±è´¥: ${error.message}`, 'error');
                    updateStatus('åˆ›å»ºäº§å“ç¼–è¾‘å™¨æµ‹è¯•å¤±è´¥ âŒ', 'error');
                }
            } else {
                log('openProductEditor å‡½æ•°æœªæ‰¾åˆ°', 'error');
                updateStatus('äº§å“ç¼–è¾‘å™¨å‡½æ•°æœªæ‰¾åˆ° âŒ', 'error');
            }
        }
        
        function testEditProduct() {
            log('æµ‹è¯•ç¼–è¾‘äº§å“åŠŸèƒ½...');
            
            const mockProduct = {
                id: 1,
                name_zh: 'æµ‹è¯•äº§å“',
                name_en: 'Test Product',
                description_zh: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•äº§å“æè¿°',
                description_en: 'This is a test product description',
                price: 99.99,
                categoryId: 1,
                featured: true
            };
            
            if (typeof window.openProductEditor === 'function') {
                try {
                    window.openProductEditor(mockProduct, 'edit');
                    log('ç¼–è¾‘äº§å“ç¼–è¾‘å™¨æˆåŠŸè°ƒç”¨', 'success');
                    updateStatus('ç¼–è¾‘äº§å“ç¼–è¾‘å™¨æµ‹è¯•æˆåŠŸ âœ…', 'success');
                } catch (error) {
                    log(`ç¼–è¾‘äº§å“ç¼–è¾‘å™¨å¤±è´¥: ${error.message}`, 'error');
                    updateStatus('ç¼–è¾‘äº§å“ç¼–è¾‘å™¨æµ‹è¯•å¤±è´¥ âŒ', 'error');
                }
            } else {
                log('openProductEditor å‡½æ•°æœªæ‰¾åˆ°', 'error');
                updateStatus('äº§å“ç¼–è¾‘å™¨å‡½æ•°æœªæ‰¾åˆ° âŒ', 'error');
            }
        }
        
        // ç­‰å¾…æ¨¡å—åŠ è½½
        window.addEventListener('load', () => {
            setTimeout(() => {
                log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹æ£€æŸ¥æ¨¡å—...');
                testModuleStatus();
            }, 1000);
        });
    </script>
    
    <!-- åŠ è½½æ¨¡å— -->
    <script src="/modules/product-form.js"></script>
    <script src="/modules/product-media.js"></script>
    <script src="/modules/product-editor.js"></script>
</body>
</html>